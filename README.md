# CIL
**Groupname:** It's raining in como

**Valentin Anklin** (15-916-281)  
**Flurin Hidber** (14-916-451)  
**Thomas Langerak** (17-911-702)  
**Amray Schwabe** (15-920-648)

**IMPORTANT:** please get your version from github.com/tlakngerak/CILSubmission. That version has the correct folder structure. 

## Installation
We ran (almost) everything on Leonhard. We recommend using a venv. 
On leonhard we load (in this order):

`ssh user@login.leonhard.ethz.ch`
`module load python_gpu/3.6.4 eth_proxy`  
`module load cuda/10.0.130`
`pip install virtualenvwrapper`
`source $HOME/.local/bin/virtualenvwrapper.sh`
`cd [workingdir]`
`pip install -r requirements.txt` 
 

## Data
The original data is included. Please run in order to get the additional data and augmented data:
1) `python download_chicago_dataset.py` (takes quite long)
2) `python create_dataset.py` (also takes quite long)

## Train + Evaluation
The models (U-Net and W-Net) can be trained by   
python experiments_wnet.py`   
on leonhard. This will also evaluate the models. One can use `bpeek JOBID` to see how far the training has progressed
This will also automatically evaluate the models. We include already trained models in /runs/

`python submit_eval.py` will submit our trained models to leonhard to be evaluated. These folders also already contain files that are submitable to kaggle. 


The plots can be generated by `python plots.py`. Due to certain dependencies this will not work on leonhard. 
This is the specific issue: https://github.com/plotly/orca. It works fine on a desktop with npm installed.
please see https://plot.ly/python/static-image-export/ for more information. 

We include the data needed for the plots in our report in /runs/
If this throws errors, it is likely due to dependencies required my plotly.
Please follow the instructions here: https://plot.ly/python/static-image-export/
 
For training a tensorboard file is written to /logdir/

**BASELINE** For the 2-Layer CNN please run:  
 `bsub -u 1 -W 25:00 -R "rusage[mem=24000, ngpus_excl_p=1]" 'python baselines.py --data 1 --epochs 1'`
